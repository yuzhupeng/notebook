# 同源分析

该方法主要为在获取到恶意样本后，很难第一时间关联到攻击者或者恶意样本提供者的信息，但是可以通过和历史恶意代码进行相似度分析，

获得历史攻击事件，从而关联到相应的组织或团体

这种溯源方法多用于定位APT组织或者某些知名的黑客团体（方程式）的行动，需要投入大量的人力，时间去完成溯源跟踪分析。

APT组织或者知名黑客团队，一般都有各自的工具定制开发部门，负责各类工具的开发，以及漏洞利用工具的量产 。

其部分划分组织架构都非常清晰，有专门负责工具开发的部门，例如：远控开发部门，硬件研究部门，漏洞挖掘部门，漏洞利用工具编写的部门等。

# 比如一些**设计思路:**

每个程序员在软件实现的时候，会使用自己比较熟悉的一套代码风格和实现算法，每个团伙或者组织在攻击目标时也会有一套自己特有的攻击方法，

针对恶意样本可以通过行为日志的相似度、代码混淆风格以及相关的实现算法进行同源判定。

# 比如一些**编码特征:**

程序员在开发过程中，经常会复用部分现有代码（加密算法，功能模块），以提高开发效率。

样本分析人员通过跟踪分析某组织的大量攻击样本后，对其工具开发人员的编码风格（函数变量命名习惯，语种信息等），

编程习惯有了深入了解。在此基础上，就能够通过编码风格准确溯源到相关组织

# 比如一些**通讯协议:**

每个恶意样本为了和之前的版本通讯协议进行兼容，一般会复用之前的通讯协议代码，

通过跟踪分析通讯数据的格式特征进行同源判定

比如用到的一些结构体

![Untitled](%E5%90%8C%E6%BA%90%E5%88%86%E6%9E%90%204fd0a107718142cfab46ce3c0913b921/Untitled.png)

..

![Untitled](%E5%90%8C%E6%BA%90%E5%88%86%E6%9E%90%204fd0a107718142cfab46ce3c0913b921/Untitled%201.png)

# 比如一些数字证书

也就是通行证