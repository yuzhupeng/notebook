# 杀软检测方式

**扫描技术**

1.  扫描压缩包技术；对压缩文件进行分析检查的技术
2.  程序防窜改防护；保护程序避免被恶意程序修改
3.  修复技术；对恶意程序所破坏的文件还原
4.  智能扫描；扫描常用磁盘，系统关键位置，时间短
5.  全盘扫描；扫描电脑全盘文件，时间长
6.  勒索软件防护；保护电脑不受勒索软件的攻击
7.  开机扫描；电脑开机时自动扫描，可以扫描压缩文档和不需要的程序

**监控技术**

1.  内存监控：当发现内存中存在病毒的时候，就会主动报警；监控所有进程；监控读取到内存中的文件；监控读取到内存的网络数据。
2.  文件监控：当发现写到磁盘上的文件中存在病毒，或者是被病毒感染，就会主动报警
3.  邮件监控：当发现电子邮件的附件存在病毒时进行拦截。office钓鱼 宏病毒 这种
4.  网页防护：阻止网络攻击和不安全下载。 mshta js脚本
5.  行为防护：提醒用户可疑的应用程序行为。低危 和中

**云查杀**（实质就是病毒库由客户端移至服务端，一般分为两种情况，例如360）

1.  客户端提取特征上传，在云端检测到对应特征所标明的是否病毒状态，并返回
2.  客户端上传特征，在云端无法检测到，则上传文件，文件通过杀软系统进行评判，得出总评分，对于无结果的，进行鉴定系统评分，总共得出结果返回给用户，并入云端库
3.  云查杀的特点基本也可以概括为特征查杀。

# 扫描引擎

**特征码扫描**

机制：将扫描信息与病毒数据库进行对比，病毒库是一直更新的，如果信息与其中的任何一个病毒特征符合，

杀毒软件就会判断此文件被病毒感染。杀毒软件在进行查杀的时候，会挑选文件内部的一段或者几段代码来作为他识别病毒的方式，

这种代码就叫做病毒的特征码；在病毒样本中，抽取特征代码；抽取的代码比较特殊，不大可能与普通正常程序代码吻合；

抽取的代码要有适当长度，一方面维持特征代码的唯一性，另一方面保证病毒扫描时候不要有太大的空间与时间的开销。



特征码识别：

1.  文件特征码：对付病毒在文件中的存在方式：单一文件特征码、复合文件特征码（通过多处特征进行判断）；

2.  内存特征码：对付病毒在内存中的存在方式：单一内存特征码、复合内存特征码优点：速度快，配备高性能的扫描引擎；准确率相对比较高，误杀操作相对较少；很少需要用户参与。

    

文件效验和法

对文件进行扫描后，可以将正常文件的内容，计算其校验和，将该校验和写入文件中或写入别的文件中保存；在文件使用过程中，

定期地或每次使用文件前，检查文件现在内容算出的校验和与原来保存的校验和是否一致，因而可以发现文件是否感染病毒。

进程行为检测（沙盒模式）VT

行为检测通过hook关键api，以及对各个高危的文件、组件做监控防止恶意程序对系统修改。

只要恶意程序对注册表、启动项、系统文件等做操作就会触发告警。

最后，行为检测也被应用到了沙箱做为动态检测，对于避免沙箱检测的办法有如下几个：

-   延时执行，部分沙箱存在运行时间限制
-   沙箱检测，对诸如硬盘容量、内存、虚拟机特征做检测
-   部分沙箱会对文件重命名，可以检测自身文件名是否被更改