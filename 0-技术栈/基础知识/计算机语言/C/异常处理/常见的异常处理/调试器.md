# 调试器

如果出现异常的程序正在被调试，

则该异常首先交给调试器处理(通过DebugPort导出异常信息)。

调试器拿到这个异常后，需要判断是否要处理该异常，

如果处理该异常返回

`DBG_CONTINUE == EXCEPTION_CONTINUE_EXECUTION` (通知APP在原EIP处继续执行)

`DBG_EXCEPTION_NOT_HANDLED == EXCEPTION_CONTINUE_SEARCH` (把异常交给APP自己的处理函数)

```c
while(!bExit)
{
    DWORD dwContinueStatus = DBG_EXCEPTION_NOT_HANDLED;
    DEBUG_EVENT debugEvent;
    WaitForDebugEvent(&debugEvent, INFINITE);
    switch ( debugEvent.dwDebugEventCode )
  {
      case EXCEPTION_DEBUG_EVENT:
          {
      EXCEPTION_DEBUG_INFO* pExcpInfo = &debugEvent.u.Exception;
      if ( MessageBox(0,_T("处理该异常?"), _T("我是调试器"),MB_YESNO)==IDYES )
  {
      dwContinueStatus = DBG_CONTINUE;
      //...
  }
  }
          break;
          //...
  }
    ContinueDebugEvent(debugEvent.dwProcessId,  debugEvent.dwThreadId, dwContinueStatus);
}
```