# 子样本 smss.exe 行为分析三

有点小复杂

可能后面再回来分析吧

运行后样本将尝试使用post方式请求域名movie.youtoboo.kro.kr

并使用UA：Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36。

样本一旦与CC连接成功后，将等待传入指令，样本有19种接收参数。

| CC指令 | 功能 |
| --- | --- |
| 3 | 获取当前目录 |
| 4 | 修改文件日期 |
| 5 | 结束特定进程 |
| 6 | 获取特定进程信息 |
| 7 | 删除文件 |
| 8 | 创建新线程并尝试移动一个文件，失败则破坏 |
| 9 | 创建进程 |
| 10 | 注册DLL |
| 11 | 分配内存空间，具体功能未知 |
| 12 | 读取文件 |
| 13 | 写入文件 |
| 14 | 获取系统时间 |
| 15 | 获取系统时间 |
| 16 | 删除注册表 |
| 17 | 获取主机名，计算机名，网卡信息 |
| 18 | 全局信息时间 |
| 19 | 获取%temp%目录 |
| 20 | 读取PMS*文件信息 |
| 21 | 读取PMS*文件信息 |