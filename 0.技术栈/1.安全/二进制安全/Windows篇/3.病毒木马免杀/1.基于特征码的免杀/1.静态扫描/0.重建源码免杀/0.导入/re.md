

# 方法

从C/C++语言出发的源码免杀

是通过修改源代码来达到二进制字节码的变化

从而逃过特征码的追踪



其实只是针对于样本开发者的角度而言

比如我们写了一个病毒出来

生成的时候,发现360报毒了

这个报毒可能是因为我们写了某一个函数导致的

于是我们可以通过在源码中修改某某函数

比如增加这个函数,减少这个函数,替换这个函数,魔改这个函数,混淆这个函数之类 来达到一个免杀的目的

```
1. sub1 //未报毒
2. sub1 sub2 //未报毒
3. sub1 sub2 sub3 //报毒
4. sub1 sub2 sub3(sub31) //未报毒
5. sub1 sub2 sub3(sub31 sub32) //报毒
6. sub1 sub2 sub3(sub31 sub32(sub321)) //报毒
```

有时我们甚至需要重写API函数来绕过免杀





源码->二进制文件: 

![image.png](img/3be4c6d9100944f4a7b673c8490b6f36.png)





# 防特征码



一种防止特征码提取或者扫描额技术

当然这个在工具也有的win7 x64的虚拟机里面

```c
char xx[]={'s','h','e','l','l','c','o','d','e',0}; //分散行shellcode字符串
char xx2[] = "shellcode";//集中形shellcode字符串
```



![image-20230726215029723](img/image-20230726215029723.png)

可以看到反汇编效果

其中第一种字符串形式来说,就不是很好写yara规则

第二种字符串形式相对来说,yara规则写起来更加方便

这样的话,就让反病毒工程师不好定位,同时也样本开发者也很好的利用了字符串