# 绕过网络检测

处理函数 void __thiscall sub_B7FD40(void *this)

![Untitled](%E7%BB%95%E8%BF%87%E7%BD%91%E7%BB%9C%E6%A3%80%E6%B5%8B%2056d86873034b4c70add506370a4ec869/Untitled.png)

v16是sub_9E4174的返回值,本来应该直接是v16=sub_9E4174(xx)的,后来被patch掉后,变样了

可以看出v16的结果决定了一些东西

v16的返回值有3种情况

1), 0

2), -1

3), 其它

如果修改跳转,会比较麻烦,就是那2个if的判断

![Untitled](%E7%BB%95%E8%BF%87%E7%BD%91%E7%BB%9C%E6%A3%80%E6%B5%8B%2056d86873034b4c70add506370a4ec869/Untitled%201.png)

所以我就进入sub_9E4174,然后去修改返回值

原始情况下,该函数是把eax最后返回

![Untitled](%E7%BB%95%E8%BF%87%E7%BD%91%E7%BB%9C%E6%A3%80%E6%B5%8B%2056d86873034b4c70add506370a4ec869/Untitled%202.png)

于是,我就去最后修改eax

![Untitled](%E7%BB%95%E8%BF%87%E7%BD%91%E7%BB%9C%E6%A3%80%E6%B5%8B%2056d86873034b4c70add506370a4ec869/Untitled%203.png)

可以看到pop ebp后,去往了mov eax,esi

esi的值反正不是0,-1

然后再去往ret 4