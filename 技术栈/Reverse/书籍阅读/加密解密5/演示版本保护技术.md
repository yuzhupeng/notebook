# 演示版本保护技术

# 序列号保护方式

### 序列号保护机制

1), 序列号=f(用户名)

然后拿着计算出来的序列号和正确的序列号比较

2), 用户名=f-(序列号)

然后拿着计算出来的用户名和正确的用户名比较

3), f1(用户名) == f2(序列号)

输入为止的序列号和用户名,然后对比f函数的结果

对于方法3,f1和f2可以是加密,也可以是解密,但是最后2个函数出来的结果是一样的,才可以验证成功

### 攻击方式

### API:断点

数据获取API: 就是处理窗口输入

提示性API: 就是你输入正确或者失败的提示性窗口

消息断点: 基于控件的一些东西

详情API见p196

### 跟踪启动流程

软件在启动的时候会验证

于是跟踪这个流程

1), 读取注册表信息判断是否注册成功

2), 读取init文件看是否成功

3), 读取一般的文件看是否成功

对于这些文件的读取也需要一些API,比如读取注册表的API

我们都可以在这些地方分析下断点,详情见196

### 数据约束性

也就是我们输入数据存在于某个函数的栈缓冲区

然后最后数据验证的时候,对比数据也存在于某个栈的缓冲区

这2个缓冲区的位置相隔会比较近,于是我们就可以通过内存搜索的方式

先搜索我们的输入,然后观察输入旁边的数据,来获取对比的数据

### 字符串定位

其实也就是根据提示性信息定位字符串,然后找到关键位置

可能需要定位中文unicode,稍微麻烦了一下下