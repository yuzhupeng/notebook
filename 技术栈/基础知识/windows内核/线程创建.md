# 线程创建

```c
void RtlUserThreadStart(PTHREAD_START_ROUTINE pfnStartAddr, PVOID pvParam)
{
	_try
	{
		ExitThread( (pfnStartAddr)(pvParam) );
	}
	_except( UnhandledExceptionFilter(GetExceptionInfomation()) )
	{
		ExitProcess( GetExceptionCode() )
	}
	// NOTE: we never get here!
}
```

Windows线程在创建时会首先创建一个线程内核对象，它是一个较小的数据结构，操作系统通过它来管理线程。

新线程可以访问进程内核对象的所有句柄、进程中的所有内存及同一进程中其它线程的栈。

创建有以下几种方式，分别说明

1. CreateThread(...) (操作系统提供的API，尽量不要使用?)
2. _beginthread(...) ps:是CreateThread(...)的封装
3. _beginthreadex(...) ps:是CreateThread(...)的封装
4. AfxBeginThread(...) (MFC提供的接口)

终结线程的几个方法：

1. 等待线程函数运行完成自动结束
2. ExitThread()，用于结束线程自身
3. TerminateThread(),所有线程都可以用该方法结束
4. 父进程关闭，子线程随之关闭

只建议使用第一种方法结束线程，其它的方式都对应有缺陷

 

参考链接:

[https://www.cnblogs.com/t427/archive/2012/11/17/2775372.html](https://www.cnblogs.com/t427/archive/2012/11/17/2775372.html)

[https://www.cnblogs.com/zqrferrari/archive/2010/07/07/1773113.html](https://www.cnblogs.com/zqrferrari/archive/2010/07/07/1773113.html)

[https://www.cnblogs.com/whiteyun/archive/2011/06/02/2067742.html](https://www.cnblogs.com/whiteyun/archive/2011/06/02/2067742.html)